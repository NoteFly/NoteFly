namespace InsertSmiley
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Text;
    using System.Windows.Forms;

    public partial class FrmSmileyChooser : Form
    {
        private string rtf;
        private int insertposition = int.MaxValue;
        private RichTextBox rtb;

        /// <summary>
        /// Creating a new instance of FrmSmileyChooser class.
        /// </summary>
        /// <param name="x"></param>
        /// <param name="y"></param>
        /// <param name="inssm"></param>
        /// <param name="insertposition"></param>
        /// <param name="rtf"></param>
        public FrmSmileyChooser(int x, int y, RichTextBox rtb, int insertposition, string rtf)
        {
            this.rtf = rtf;
            this.rtb = rtb;
            this.insertposition = insertposition;
            InitializeComponent();
            if (x > (this.Width/2) && y > (this.Height/2))
            {
                this.btnSmileySmile.Select();
                if ((x > (Screen.PrimaryScreen.WorkingArea.Width - (this.Width / 2))) || (y > (Screen.PrimaryScreen.WorkingArea.Height - (this.Height / 2))))
                {
                    this.Location = new Point(x - this.Width, y - this.Height);
                }
                else
                {
                    this.Location = new Point(x - (this.Width / 2), y - (this.Height / 2));
                }
            }
            else
            {
                this.Location = new Point(x, y);
            }
        }

        /// <summary>
        /// Gets the RTF pic tag for a smiley image.
        /// </summary>
        /// <param name="smileybtnname"></param>
        /// <returns></returns>
        private string GetSmileyRTFImage(string smileybtnname)
        {
            const string BTNPREFIXNAME = "btnSmiley";
            string rtfsmiley = string.Empty;
            switch (smileybtnname)
            {
                case BTNPREFIXNAME + "Smile":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe0000c9ff0000b4ff0000e5ff00000000000000000000
000000111112222211111011122bbbb922111011266aaaaa6921101266c00000a6921012680888
880a6210268088888880a920278888888888ab20258888888888ab20257880888088ab20247880
888088a92012578888888862101245888888869210112347788869211011122345562211101111
122222111110040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Wink":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe0000c9ff0000b4ff0000e5ff00000000000000000000
000000111112222211111011122bbbb922111011266aa00a6921101266c80000a6921012688000
000a621026880000000ca920278888888808ab20258888888888ab20257800188088ab20247888
081088a92012578888108862101245788808869210112347788869211011122345562211101111
122222111110040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Sad":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe0000c9ff0000b4ff0000e5ff00000000000000000000
000000111112222211111011122bbbb922111011266aaaaa6921101266088880a6921012688000
088a621026888888888ca920278010888010ab202501100800110b202501111811110b20247011
888110a92012570088800862101245788888869210112347788869211011122345562211101111
122222111110040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Confuzzed":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003c202000000009902000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e000400000007010400040000000701040099020000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100080000000000000000
000000000000000000000000000000000000000000ffffff00557d7f000e686b001d555400567b
7d0039a2a0006beae90099fffc008bfffb0066fffa003ddddd00169595005bdbd90081fffb0059
fff90045fff9003cfff80016bfc100030303004efff90035fff8002afff80017fff8000ffff700
07b8c10007fff70007f8f50006f2fe00037c850025d7d70003fffd0003effc002bf9f30036fff8
002ffff8001afff70003faff0003f4fe0003eef80003e2ec000c4b4c002ffffa002bfffc001fff
fa0012fffd0003fdff0003fbff0003f8ff0003f3fc0003ebf50003dee80003e7f40023f9f90021
f9f70018fbfa0003dee90003d0db00175353000be7ec0008e5ea0003f1f70003f3fb0003f1fb00
03d8e30003aab3000374790003d3db0003dfe80003e1ea0003eaf40003d0dc00039ca60003cbd4
0003d1dd0003dae40003dde80003dfea0003d9e30003ced80003bec8000399a30003c7d10003c1
cc000396a10003a6b0000441450000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000001010101010204563a020101
010101000101010242555347534842020101010001010348475252525352525403010100010248
494a4b4c4d384e4f50510301000142431344454632131347474742014b02193b3c133d3e133f25
13254041020004343536371313303038251325393a00291a2a2b2c2d2e2f303030313233290004
2122232413132513131a26272804ff021e11131113131f13131a132019023f010c140f131a1a1a
1b1a131a1c1d010001020b0e0e13141516131718190201000101020d09080e0a0f101112030101
0001010102060708090a0b0c020101010001010101010203040305010101010100040000002701
ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Lair":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe0000b4ff000000000000000000000000000000000000
000000111112222211111011122aaaa92211101126660666692110126688800866921012688888
8886621026888882888869202788888822226a202588888888882a202578808822226a20247880
888088692012508888888062101245088888069210112347788869211011122345562211101111
122222111110040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Omg":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff0000b4ff0000c9ff0000e5ff00009dfe00000000000000000000
0000001111122222111110111229999c22111011266a000a6c21101266b8000ba6c21012688888
888a621026888888888bac20278888888888a92025000888880009202011108880111020011111
080111110001101108011011000111110801111100101110788011101011000345560001101111
122222111110040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Dance":
                    rtfsmiley = @"{\pict\wmetafile8\picw609\pich423\picwgoal345\pichgoal240 
010009000003ca0000000000a100000000000400000003010800050000000b0200000000050000
000c0210001700030000001e0004000000070104000400000007010400a1000000410b2000cc00
100017000000000010001700000000002800000017000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe00a1a1a1007f7e7f00d7fff60000b4ff004f525400c7
c6c70011abbbba111111111b1cb1101bbffffea122222111bcb110ba1bfcffeadddd9221b1cb10
bcbabfc1fe666666921bcb10aba3baa1fe888886692aba101bcbbbf1fe888000662111101abbfc
1ee888000006921110111bbbbe8880888006d2111011bc3b588888888806d2111011bcb2578888
888886d211101bc1b24788888888869211101bcb112578808880862111101aba11245780888069
211110111111123477888692111110111111112234556221111110111111111122222111111110
040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Mad":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003c202000000009902000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e000400000007010400040000000701040099020000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100080000000000000000
000000000000000000000000000000000000000000ffffff00ad8dde009fa09b0054466e005757
560025203800a2a39e005d489900c29eff00ae8aff007f5fdd0045328500c7a4ff00d9b5ff00a7
85ff00785acf00432d9e00110737008561ff005d3be8000a022b004224bc00b290ff005530f300
320bd2006947fc00261574007253d6009876ff0040404000603def00282442007d5bfc008a65ff
007755ff005936f9002f05d9002b03d6004422de004828d500401ec3006140fc00411eca002e09
c9004121cb00300bca002002a0001b0287002302ac003816bd003818b5002a08b6001605560013
054d000e033d000802230016045f002b08bc00280a9d00200e6e00281576002a0ba7002e0ec400
2c07b700260b9b00250b9700170566002d1499003011b3002a0bae000d00550020038b003314b8
00c4c4c300270ba700241c3e000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000010101020305204c20050303
010101000101070543424b463b4847050701010001030c4849453e3e3e3e3e30204a0100020512
1244453446463e463547050300033c3d37123e3f3f404136374243034b04161634351536353738
393a3a3b04002014142c2e2f30303031262d323320002023232a2b26262626262c2d292d060020
212223241e2526261e2728282920ff041c0f1d1e1e1919191e1e1f1416043f030c171200001819
180000121a1b030002040b120d0d1313130d141516040200010704080d0e0d0a0a0f1011040701
0001010705080209090a0b0c040701010001010102030405060504030201010100040000002701
ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Angel":
                    rtfsmiley = @"{\pict\wmetafile8\picw397\pich397\picwgoal225\pichgoal225 
010009000003a600000000007d00000000000400000003010800050000000b0200000000050000
000c020f000f00030000001e00040000000701040004000000070104007d000000410b2000cc00
0f000f00000000000f000f0000000000280000000f0000000f0000000100040000000000000000
000000000000000000000000000000000000000000ffffff0045454500ebffff00c7ffff0093fe
ff0000ceff0013fdff0000eaff00009dfe0000c9ff0000b4ff0000e5ff00000000000000000000
000000111112222211111011122bbbb922111011266aaaaa6921101266c00000a6921012680888
880a6210268088888880a920278088888880ab20258888888888ab20257880888088ab20247880
888088a92012578888888862101233333333339210113347788833311011122345562211101111
122222111110040000002701ffff030000000000
}";
                    break;
            }

            return rtfsmiley;
        }

        /// <summary>
        /// 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void btnSmileyChoice_Click(object sender, EventArgs e)
        {
            Button btnsmiley = (Button)sender;
            string rtfsmiley = this.GetSmileyRTFImage(btnsmiley.Name);
            rtb.Rtf = this.rtf.Insert(insertposition, rtfsmiley);
            this.Close();
        }

        private void FrmSmileyChooser_Deactivate(object sender, EventArgs e)
        {
            this.Close();
        }

    }
}
