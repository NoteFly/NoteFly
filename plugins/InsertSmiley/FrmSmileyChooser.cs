namespace InsertSmiley
{
    using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Text;
    using System.Windows.Forms;

    public partial class FrmSmileyChooser : Form
    {
        private string rtf;
        private int insertposition = int.MaxValue;
        private RichTextBox rtb;

        /// <summary>
        /// Creating a new instance of FrmSmileyChooser class.
        /// </summary>
        /// <param name="x"></param>
        /// <param name="y"></param>
        /// <param name="inssm"></param>
        /// <param name="insertposition"></param>
        /// <param name="rtf"></param>
        public FrmSmileyChooser(int x, int y, RichTextBox rtb, int insertposition, string rtf)
        {
            this.rtf = rtf;
            this.rtb = rtb;
            this.insertposition = insertposition;
            InitializeComponent();
            if (x > (this.Width/2) && y > (this.Height/2))
            {
                this.btnSmileySmile.Select();
                if ((x > (Screen.PrimaryScreen.WorkingArea.Width - (this.Width / 2))) || (y > (Screen.PrimaryScreen.WorkingArea.Height - (this.Height / 2))))
                {
                    this.Location = new Point(x - this.Width, y - this.Height);
                }
                else
                {
                    this.Location = new Point(x - (this.Width / 2), y - (this.Height / 2));
                }
            }
            else
            {
                this.Location = new Point(x, y);
            }
        }

        /// <summary>
        /// Gets the RTF pic tag for a smiley image.
        /// </summary>
        /// <param name="smileybtnname"></param>
        /// <returns></returns>
        private string GetSmileyRTFImage(string smileybtnname)
        {
            const string BTNPREFIXNAME = "btnSmiley";
            string rtfsmiley = string.Empty;
            switch (smileybtnname)
            {
                case BTNPREFIXNAME + "Confuzzed":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff000024
330000000000000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444444011104444444444440124454444
555544420445544554455440044455554444544004444444444444400444444444444440044444
444444444004440044400444402444404440444442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Cool":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff000083
9e0000d1f70001d2f8000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444447011104444444444470124444000
000444420644044444404440044444444444444004444444444444400444444444444440044000
044000044004400004400004602440000000000442105444444444450111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Cry":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff00ff94
000000d1f700ffc2490001d2f80000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444448011104444444444480124444044
440444420674440000444740047744444444774004477444444774400444744444474440044474
444474444004440044400444602444554445544442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Lol":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff0000d1
f7000000ff0001d2f8000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444447011104444440000470124444440
666004420544444066660440044000000000044004444444444444400444444444444440044444
444444444004440044400444502444004440044442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Mad":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f00080808000000ff000000
000000000000000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444444011104444444444440124440444
444044420444044444404440044440000004444004444444444444400444444444444440044444
444444444004440044400444402444044444044442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Oh":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff0000d1
f70001d2f800000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444446011104444000044460124444011
110444420544401111044440044444000044444004444444444444400444444444444440044444
444444444004440004400044502444000440004442104400044000440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Sad":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff0000d1
f70001d2f800000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444446011104444444444460124440444
444044420544404444044440044444000044444004444444444444400444444444444440044444
444444444004440044400444502444004440044442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Smile":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff0000d1
f70001d2f800000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104440000446011104440444404460124440444
444044420540444444440440044444444444444004444444444444400444444444444440044444
444444444004440044400444502444004440044442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;

                case BTNPREFIXNAME + "Wink":
                    rtfsmiley = @"{\pict\wmetafile8\picw423\pich423\picwgoal240\pichgoal240 
010009000003aa00000000008100000000000400000003010800050000000b0200000000050000
000c0210001000030000001e000400000007010400040000000701040081000000410b2000cc00
100010000000000010001000000000002800000010000000100000000100040000000000000000
000000000000000000000000000000000000000000ffffff000f0f0f000808080000d8ff0000d1
f70001d2f800000000000000000000000000000000000000000000000000000000000000000000
000000111120000002111111104444444401111104444444446011104444444444460124444000
000444420544044444004440044444444444444004444444444444400444444444444440044444
444444444004440044400444502444440440044442104444444444440111044444444440111110
4444444401111111200000321111040000002701ffff030000000000
}";
                    break;
            }

            return rtfsmiley;
        }

        /// <summary>
        /// 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void btnSmileyChoice_Click(object sender, EventArgs e)
        {
            Button btnsmiley = (Button)sender;
            string rtfsmiley = this.GetSmileyRTFImage(btnsmiley.Name);
            rtb.Rtf = this.rtf.Insert(insertposition, rtfsmiley);
            this.Close();
        }

        private void FrmSmileyChooser_Deactivate(object sender, EventArgs e)
        {
            this.Close();
        }

    }
}
